namespace = albion

# Albion seceedes from Britain
albion.1 = {
	type = country_event
	placement = ROOT
	title = albion.1.tt
	desc = albion.1.dd
	flavor = albion.1.ff

	duration = 1

	event_image = {
		texture = gfx/coat_of_arms/textured_emblems/albion.dds
	}

	trigger = {
		NOT = {
			exists = c:ABI
			has_global_variable = albion_seceeded_globvar
		}
		owns_entire_state_region = STATE_LANCASHIRE
		s:STATE_LANCASHIRE = {
			any_scope_state = {
				radical_fraction = {
					value = 0.5
				}
				OR = {
					any_scope_pop = {
						percent = 0.4
						culture = cu:albionian
					}
					any_scope_pop = {
						percent = 0.4
						religion = rel:druidism
					}
				}
			}
		}
	}

	immediate = {
		set_global_variable = albion_seceeded_globvar
		create_albion = yes
		c:ABI ?= { set_up_albion_gov = yes }
	}

	option = {
		name = albion.1.a
		default_option = yes
	}

	option = {
		name = albion.1.b

		trigger = { c:GBR ?= this }

		play_as = c:ABI
	}

	after = {
		set_up_albionian_claims = yes
		if = {
			limit = { NOT = { has_global_variable = oberon_happened_globvar } }
			c:ABI ?= {
				create_character = {
					template = oberon_character_template
				}
			}
		}
		trigger_event = {
			id = albion.2
			popup = yes
			days = 7
		}
	}
}

# Make Oberon leader
albion.2 = {
	type = country_event
	placement = ROOT
	title = albion.2.tt
	desc = albion.2.dd
	flavor = albion.2.ff

	duration = 1

	event_image = {
		texture = gfx/coat_of_arms/textured_emblems/albion.dds
	}

	trigger = {
		# Gets triggered by albion.1
	}

	immediate = {
		random_scope_character = {
			limit = {
				has_template = oberon_character_template
			}
			save_scope_as = oberon_scope
		}
	}

	option = {
		name = albion.2.a
		default_option = yes

		scope:oberon_scope = {
			set_character_as_ruler = yes
		}
	}
}
