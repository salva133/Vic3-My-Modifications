namespace = community_tension

# Black Crime arises
community_tension.1 = {
	type = country_event
	placement = root

	title = community_tension.1.tt
	desc = community_tension.1.dd
	flavor = community_tension.1.ff

	duration = 3

	cooldown = {
		months = 12
	}

	icon = gfx/interface/icons/timed_modifier_icons/modifier_fist_black.dds

	event_image = {
		video = "southamerica_slaves_night"
	}

	trigger = {
		game_date > 1900.1.1
		country_is_a_judeo_christian_nation = yes
		any_scope_state = {
			is_incorporated = yes
			NOT = { has_modifier = modifier_black_communities }
			any_scope_pop = {
				culture = {
					OR = {
						has_discrimination_trait = african_heritage
						has_discrimination_trait = middle_eastern_heritage
						has_discrimination_trait = south_asian_heritage
					}
				}
				percent > 0.13
			}
		}
	}

	immediate = {
		random_scope_state = {
			limit = {
				is_incorporated = yes
				NOT = { has_modifier = modifier_black_communities }
				any_scope_pop = {
					culture = {
						OR = {
							has_discrimination_trait = african_heritage
							has_discrimination_trait = middle_eastern_heritage
							has_discrimination_trait = south_asian_heritage
						}
					}
					percent > 0.13
				}
			}
			save_scope_as = community_tension_state_blacks
		}
	}

	option = {
		name = community_tension.1.a
		default_option = yes

		scope:community_tension_state_blacks = {
			add_modifier = modifier_black_communities
		}
	}
}

# Black Crime subsides
community_tension.2 = {
	type = country_event
	placement = root

	title = community_tension.2.tt
	desc = community_tension.2.dd
	flavor = community_tension.2.ff
	
	duration = 3

	cooldown = {
		months = 12
	}

	icon = gfx/interface/icons/timed_modifier_icons/modifier_fist_black.dds

	event_image = {
		video = "southamerica_slaves_night"
	}

	trigger = {
		OR = {
			game_date < 1900.1.1
			AND = {
				country_is_a_judeo_christian_nation = yes
				any_scope_state = {
					has_modifier = modifier_black_communities
					any_scope_pop = {
						culture = {
							OR = {
								has_discrimination_trait = african_heritage
								has_discrimination_trait = middle_eastern_heritage
								has_discrimination_trait = south_asian_heritage
							}
						}
						percent < 0.05
					}
				}
			}
		}
	}

	immediate = {
		random_scope_state = {
			limit = {
				has_modifier = modifier_black_communities
				any_scope_pop = {
					culture = {
						OR = {
							has_discrimination_trait = african_heritage
							has_discrimination_trait = middle_eastern_heritage
							has_discrimination_trait = south_asian_heritage
						}
					}
					percent < 0.05
				}
			}
			save_scope_as = community_tension_state_blacks
		}
	}

	option = {
		name = community_tension.2.a
		default_option = yes

		scope:community_tension_state_blacks = {
			remove_modifier = modifier_black_communities
		}
	}
}

# Arab-Muslim Crime arises
community_tension.3 = {
	type = country_event
	placement = root

	title = community_tension.3.tt
	desc = community_tension.3.dd
	flavor = community_tension.3.ff
	
	duration = 3

	cooldown = {
		months = 12
	}

	icon = gfx/interface/icons/timed_modifier_icons/modifier_fist_black.dds

	event_image = {
		video = "middleeast_upperclass_party"
	}

	trigger = {
		game_date > 1900.1.1
		country_is_a_judeo_christian_nation = yes
		any_scope_state = {
			is_incorporated = yes
			NOT = { has_modifier = modifier_muslim_communities }
			any_scope_pop = {
				religion = {
					has_discrimination_trait = muslim
				}
				percent > 0.13
			}
		}
	}

	immediate = {
		random_scope_state = {
			limit = {
				is_incorporated = yes
				NOT = { has_modifier = modifier_muslim_communities }
				any_scope_pop = {
					religion = {
						has_discrimination_trait = muslim
					}
					percent > 0.13
				}
			}
			save_scope_as = community_tension_state_muslims
		}
	}

	option = {
		name = community_tension.3.a
		default_option = yes

		scope:community_tension_state_muslims = {
			add_modifier = modifier_muslim_communities
		}
	}
}

# Arab-Muslim Crime subsides
community_tension.4 = {
	type = country_event
	placement = root

	title = community_tension.4.tt
	desc = community_tension.4.dd
	flavor = community_tension.4.ff
	
	duration = 3

	cooldown = {
		months = 12
	}

	icon = gfx/interface/icons/timed_modifier_icons/modifier_fist_black.dds

	event_image = {
		video = "middleeast_upperclass_party"
	}

	trigger = {
		OR = {
			game_date < 1900.1.1
			AND = {
				country_is_a_judeo_christian_nation = yes
				any_scope_state = {
					is_incorporated = yes
					has_modifier = modifier_muslim_communities
					any_scope_pop = {
						religion = {
							has_discrimination_trait = muslim
						}
						percent < 0.05
					}
				}
			}
		}
	}

	immediate = {
		random_scope_state = {
			limit = {
				is_incorporated = yes
				has_modifier = modifier_muslim_communities
				any_scope_pop = {
					religion = {
						has_discrimination_trait = muslim
					}
					percent < 0.05
				}
			}
			save_scope_as = community_tension_state_muslims
		}
	}

	option = {
		name = community_tension.4.a
		default_option = yes

		scope:community_tension_state_muslims = {
			remove_modifier = modifier_muslim_communities
		}
	}
}

# Dundee Incident
community_tension.5 = {
	type = country_event
	placement = root

	title = community_tension.5.tt
	desc = community_tension.5.dd
	flavor = community_tension.5.ff

	duration = 3

	icon = gfx/interface/icons/timed_modifier_icons/modifier_fist_black.dds

	event_image = {
		texture = gfx/event_images/dundee_girl.dds
	}

	trigger = {
		NOT = { has_global_variable = dundee_incident_happened_globvar }
		has_law = law_type:law_multicultural
		has_technology_researched = camera
		country_is_a_judeo_christian_nation = yes
		s:STATE_LOWLANDS = {
			any_scope_state = {
				is_incorporated = yes
				any_scope_pop = {
					state_has_muslim_indians = yes
					percent > 0.12
				}
			}
		}
	}

	immediate = {
		set_global_variable = dundee_incident_happened_globvar
		s:STATE_LOWLANDS = {
			every_scope_state = {
				limit = {
					owner = root
					is_incorporated = yes
				}
				save_scope_as = incident_state
			}
		}
	}

	option = {
		name = community_tension.5.a
		default_option = yes

		scope:incident_state = {
			if = {
				limit = {
					NOT = { has_modifier = modifier_dundee_incident }
				}
				add_modifier = {
					name = modifier_dundee_incident
					months = 37
				}
			}
		}
	}
}

# We will not be replaced
community_tension.6 = {
	type = country_event
	placement = root

	title = community_tension.6.tt
	desc = community_tension.6.dd
	flavor = community_tension.6.ff

	duration = 3

	cooldown = {
		years = 5
	}

	icon = gfx/interface/icons/timed_modifier_icons/modifier_fist_black.dds

	event_image = {
		texture = gfx/event_images/dundee_girl.dds
	}

	trigger = {
		has_law = law_type:law_multicultural
		country_is_a_judeo_christian_nation = yes
		any_scope_state = {
			NOT = { has_modifier = modifier_nationalist_agitation }
			primary_cultures_percent_state < 0.66
			any_scope_pop = {
				culture = {
					is_primary_culture_of = root
				}
				state = {
					radical_fraction = {
						value > 0.66
					}
				}
			}
		}
		any_political_movement = {
			is_political_movement_type = movement_cultural_majority
			political_movement_radicalism > 0.33
			political_movement_support > 0.2
		}
		any_interest_group = {
			ig_is_socialist = yes
			ig_is_reactionary = yes
		}
	}

	immediate = {
		random_scope_state = {
			limit = {
				NOT = { has_modifier = modifier_nationalist_agitation }
				primary_cultures_percent_state < 0.66
				any_scope_pop = {
					culture = {
						is_primary_culture_of = root
					}
					state = {
						radical_fraction = {
							value > 0.66
						}
					}
				}
			}
			save_scope_as = nationalist_agitation_state
		}
	}

	option = {
		name = community_tension.6.a
		default_option = yes

		scope:nationalist_agitation_state = {
			add_modifier = {
				name = modifier_nationalist_agitation
				years = 3
			}
		}
	}
}
