ig_secret_police = {
	color = rgb{ 0 0 0 }
	texture = gfx/interface/icons/ig_icons/ig_secret_police.dds
	layer = "revolution_dynamic_petty_bourgeoisie"
	index = 9

	ideologies = {
		ideology_patriotic
	}

	character_ideologies = {
		ideology_despotic_utopian
		ideology_authoritarian
		ideology_reactionary
		ideology_burgundist
		ideology_fascist
		ideology_ethno_nationalist
		ideology_integralist

	}

	# Deprecated; use on_enable effect to assign traits instead
	traits = {
		ig_trait_treasury_bonds
		ig_trait_middle_managers
		ig_trait_xenophobia
	}

	enable = {
		NOR = {
			is_country_type = colonial
			is_country_type = decentralized
			is_country_type = unrecognized
		}
		has_law_or_variant = law_type:law_secret_police
		institution_investment_level = {
			institution = institution_home_affairs
			value > 1
		}
	}

	on_enable = {
		owner = {
			ig:ig_secret_police = {
				set_ig_trait = ig_trait:ig_trait_treasury_bonds
				set_ig_trait = ig_trait:ig_trait_middle_managers
				set_ig_trait = ig_trait:ig_trait_xenophobia
			}
			set_secret_police_ig_name = yes
		}
	}

	on_disable = {
		every_scope_character = {
			limit = {
				interest_group = { is_interest_group_type = ig_secret_police }
			}
			exile_character = yes
		}
	}

	priority_cultures = {}

	on_character_ig_membership = {}

	pop_potential = {
		is_employed = yes
		literacy_rate > 0.75
		pop_acceptance >= acceptance_status_5
		OR = {
			is_pop_type = clerks
			pop_employment_building = building_government_administration
			pop_employment_building_group = bg_military
		}
	}

	pop_weight = {
		value = 1

		if = {
			limit = { pop_acceptance >= acceptance_status_5 }
			if = {
				limit = { is_pop_type = clerks }
				desc = "POP_CLERKS"
				add = 2
			}
			if = {
				limit = { is_pop_type = soldiers }
				desc = "POP_SOLDIERS"
				add = 2
			}
			if = {
				limit = { is_pop_type = officers }
				desc = "POP_OFFICERS"
				add = 2
			}
			if = {
				limit = { is_pop_type = bureaucrats }
				desc = "POP_BUREAUCRATS"
				add = 2
				multiply = owner.institution:institution_home_affairs.investment
			}
		}
		multiply = {
			desc = "LEADER_POPULARITY"
			scope:interest_group = {
				leader ?= {
					value = popularity
					multiply = 0.0025
					add = 1
					max = 1.25
					min = 0.75
				}
			}
		}
		if = {
			limit = {
				scope:interest_group = { is_in_government = yes }
			}
			multiply = {
				desc = "IN_GOVERNMENT_ATTRACTION"
				value = 1
				add = scope:interest_group.modifier:interest_group_in_government_attraction_mult
				min = 0
			}
		}
		if = {
			limit = {
				owner.ig:ig_secret_police = { is_in_government = yes }
			}
			multiply = { # Multiplied by 1.25x max
				desc = "POP_LOYALISTS"
				value = pop_loyalist_fraction
				divide = 4
				add = 1
			}
		}
		if = {
			limit = {
				owner.ig:ig_secret_police = { is_in_government = no }
			}
			multiply = { # Multiplied by 1.25x max
				desc = "POP_RADICALS"
				value = pop_radical_fraction
				divide = 4
				add = 1
			}
		}
		if = {
			limit = {
				owner = { has_law = law_type:law_outlawed_dissent }
			}
			desc = "LAW_OUTLAWED_DISSENT"
			multiply = 2
		}
		if = {
			limit = {
				owner = { has_law = law_type:law_censorship }
			}
			desc = "LAW_CENSORSHIP"
			multiply = 1.5
		}
	}

	# It is generally unlikely that the chief of SP will become Monarchs
	monarch_weight = {
		value = 0.01
		# Monarch is not likely to adopt a marginal IG
		if = {
			limit = {
				owner.ig:ig_secret_police = { is_marginal = yes }
			}
			multiply = { value = 0.1 }
		}
		# Monarch is more likely to adopt a Powerful IG
		if = {
			limit = {
				owner.ig:ig_secret_police = { is_powerful = yes }
			}
			multiply = { value = 2 }
		}
		# More likely with Elected Bureaucrats
		if = {
			limit = {
				owner = { has_law_or_variant = law_type:law_elected_bureaucrats }
			}
			multiply = { value = 1.5 }
		}
		# More likely with ethnostate
		if = {
			limit = {
				owner = { has_law_or_variant = law_type:law_ethnostate }
			}
			multiply = { value = 2 }
		}
	}

	agitator_weight = {
		# Agitators more likely to come from populist IG's rather than elitist
		value = 0.5
		# Agitators will never be part of a marginalized IG
		if = {
			limit = {
				owner.ig:ig_secret_police = { is_marginal = yes }
			}
			multiply = { value = 0 }
		}
	}

	commander_weight = { value = 0.2 }

	executive_weight = {
		value = 0.5
		
		# The company owning BIC should not get non-industrialist executives
		if = {
			limit = {
				owner = {
					NOT = { exists = ig:ig_secret_police }
				}
			}
			multiply = { value = 0 }
		}
	}

	noble_chance = {
		value = 0.0
		if = {
			limit = {
				owner = { has_law_or_variant = law_type:law_hereditary_bureaucrats }
			}
			add = { value = 0.1 }
		}
	}

	female_commander_chance = {
		value = 0.0
		if = {
			limit = {
				owner = { has_law_or_variant = law_type:law_womens_suffrage }
			}
			add = { value = 0.1 }
		}
	}
	
	female_executive_chance = {
		value = 0.0
		if = {
			limit = { has_law_or_variant = law_type:law_free_trade }
			if = {
				limit = {
					owner = { has_law_or_variant = law_type:law_women_own_property }
				}
				add = { value = 0.01 }
			}
			if = {
				limit = {
					owner = { has_law_or_variant = law_type:law_women_in_the_workplace }
				}
				add = { value = 0.02 }
			}
			if = {
				limit = {
					owner = { has_law_or_variant = law_type:law_womens_suffrage }
				}
				add = { value = 0.03 }
			}
		}
	}

	female_politician_chance = {
		value = 0.0
		if = {
			limit = {
				owner = { has_law_or_variant = law_type:law_womens_suffrage }
			}
			add = { value = 0.1 }
		}
	}

	female_agitator_chance = {
		value = 0.0
		if = {
			limit = {
				owner = { has_law_or_variant = law_type:law_women_own_property }
			}
			add = { value = 0.01 }
		}	
		
		if = {
			limit = {
				owner = { has_law_or_variant = law_type:law_women_in_the_workplace }
			}
			add = { value = 0.02 }
		}

		if = {
			limit = {
				owner = { has_law_or_variant = law_type:law_womens_suffrage }
			}
			add = { value = 0.03 }
		}
	}

	# The chance that a commander belonging to this IG takes over leadership when it changes
	# scope:character is the most popular commander in the IG
	commander_leader_chance = {
		value = 0.1

		if = {
			limit = { has_law_or_variant = law_type:law_appointed_bureaucrats }
			multiply = 3
		}
		if = {
			limit = { exists = scope:character }
			multiply = {
				value = 1
				add = scope:character.popularity
				min = 0
			}
		}
	}

	# The chance that a executive belonging to this IG takes over leadership when it changes
	# scope:character is the most popular executive in the IG
	executive_leader_chance = {
		value = 0

		if = {
			limit = { has_law_or_variant = law_type:law_free_trade }
			add = 0.5
		}
	}
}
